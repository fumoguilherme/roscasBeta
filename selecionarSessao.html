<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <title>ROSCAS| Sessão</title>

    <!-- Favicon-->
    <link rel="icon" href="favicon.ico" type="image/x-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&subset=latin,cyrillic-ext" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" type="text/css">

    <!-- Bootstrap Core Css -->
    <link href="plugins/bootstrap/css/bootstrap.css" rel="stylesheet">

    <!-- Waves Effect Css -->
    <link href="plugins/node-waves/waves.css" rel="stylesheet" />

    <!-- Sweetalert Css -->
    <link href="plugins/sweetalert/sweetalert.css" rel="stylesheet" />

    <!-- Animation Css -->
    <link href="plugins/animate-css/animate.css" rel="stylesheet" />

    <!-- Bootstrap Select Css -->
    <link href="plugins/bootstrap-select/css/bootstrap-select.css" rel="stylesheet" />

    <!-- Custom Css -->
    <link href="css/style.css" rel="stylesheet">

    <!-- AdminBSB Themes. You can choose a theme from css/themes instead of get all themes -->
    <link href="css/themes/all-themes.css" rel="stylesheet" />
</head>



<body class="theme-green">
<!-- Page Loader -->
<div class="page-loader-wrapper">
    <div class="loader">
        <div class="preloader">
            <div class="spinner-layer pl-red">
                <div class="circle-clipper left">
                    <div class="circle"></div>
                </div>
                <div class="circle-clipper right">
                    <div class="circle"></div>
                </div>
            </div>
        </div>
        <p>Please wait...</p>
    </div>
</div>
<!-- #END# Page Loader -->
<!-- Overlay For Sidebars -->
<div class="overlay"></div>
<!-- #END# Overlay For Sidebars -->
<!-- Search Bar -->
<div class="search-bar">
    <div class="search-icon">
        <i class="material-icons">search</i>
    </div>
    <input type="text" placeholder="START TYPING...">
    <div class="close-search">
        <i class="material-icons">close</i>
    </div>
</div>
<!-- #END# Search Bar -->
<!-- Top Bar -->
<nav class="navbar">
    <div class="container-fluid">
        <div class="navbar-header">

            <div class="nav navbar-nav navbar-right">
                <a class=" navbar-right navbrandimg bg-light-blue collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false" >
                    <span><strong>T </strong> </span>
                </a>

                <a href="menu.html" class="navbrandIco"> <i class=" col-white font-40 material-icons">home</i> </a>

            </div>
            <!--<a href="javascript:void(0);" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false"></a>-->



            <!--<span class="navbrand" >ROSCAS</span>-->

        </div>
        <div class="collapse navbar-collapse" id="navbar-collapse">
            <ul class="nav navbar-nav navbar-right">

                <!-- Notifications -->
                <li class="dropdown">
                    <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown" role="button">
                        <i class="material-icons">person</i>
                        <span id="nome_tecnico"> Técnico</span>
                    </a>
                    <ul class="dropdown-menu pull-right">
                        <li><a href="javascript:void(0);"><i class="material-icons">person</i>Perfil</a></li>
                        <li role="separator" class="divider"></li>
                        <li><a href="javascript:void(0);"><i class="material-icons">group</i>Grupos</a></li>
                        <li role="separator" class="divider"></li>
                        <li><a href="index.html"><i class="material-icons">input</i>Sign Out</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<section class="content">
    <div class="container-fluid">
        <div class="block-header">
            <h2 class="text-center"> <strong> Sessões </strong> </h2>
        </div>

        <!-- Input Group -->
        <div class="row clearfix">

                <div class="card">
                    <div class="body">
                        <div class="row clearfix">

                            <div class="col-xs-9">
                                <div class="input-group">
                                        <span class="input-group-addon">
                                            <i class="material-icons">person</i>
                                        </span>
                                    <div class="form-line">
                                        <input type="text" id="membro_ID"  placeholder="ID/Nome">
                                    </div>
                                </div>
                            </div>
                            <div class=" text-center  col-xs-3">
                                <button type="button" class="btn btn-sm btn-info waves-effect" id="bt_procurar">
                                    <i class="material-icons">search</i>
                                </button>
                            </div>

                            <div class="col-xs-12 col-md-9 col-lg-9">
                                <div class="input-group">
                                        <span class="input-group-addon">
                                            <i class="material-icons">people</i>
                                        </span>
                                    <select nome="membro_sexo" id="membro_sexo" class="form-control show-tick">
                                        <option value="0">(Sessão)</option>
                                        <option value="sessao1">Sessão 1</option>
                                        <option value="sessao2">Sessão 2</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-xs-6  col-md-4">
                                <a class="btn btn-block bg-green waves-effect" href="gerirGrupo.html" type="exit">Cancelar</a>
                            </div>
                            <div class="col-xs-6  col-md-4">
                                <button class="btn btn-block bg-light-green waves-effect" id="btt_add_membro">Próximo</button>
                            </div>

                            </div>







                        </div>
                    </div>
            </div>
        </div>


    </div>
</section>

<!-- Jquery Core Js -->
<script src="plugins/jquery/jquery.min.js"></script>

<!-- Bootstrap Core Js -->
<script src="plugins/bootstrap/js/bootstrap.js"></script>

<!-- Select Plugin Js -->
<script src="plugins/bootstrap-select/js/bootstrap-select.js"></script>

<!-- Slimscroll Plugin Js -->
<script src="plugins/jquery-slimscroll/jquery.slimscroll.js"></script>

<!-- Bootstrap Notify Plugin Js -->
<script src="plugins/bootstrap-notify/bootstrap-notify.js"></script>

<!-- Waves Effect Plugin Js -->
<script src="plugins/node-waves/waves.js"></script>

<!-- SweetAlert Plugin Js -->
<script src="plugins/sweetalert/sweetalert.min.js"></script>



<!-- Custom Js -->
<script src="js/admin.js"></script>
<script src="js/pages/ui/dialogs.js"></script>
<script src="js/pages/forms/advanced-form-elements.js"></script>


<!-- Demo Js -->
<script src="js/demo.js"></script>

<script src="js/pages/ui/notifications.js"></script>

<script src="js/roscas/config.js"></script>

<script>

    function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec(location.search);
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
    };

    var html = getUrlParameter('token');

    $('#btt_add_membro').on('click', function () {

        var membro_sexo = $("#membro_sexo").val();

        var membro_nome = $("#membro_nome").val();

        var membro_actividade = $("#membro_actividade").val();

        var membro_contacto = $("#contacto_numero").val();

        var membro_endereco = $("#endereco_avenida").val();

        var membro_herdeiro = $("#herdeiro_nome").val();

        var herdeiro_grau_parent = $("#herdeiro_grau_parent").val();

        var tipo_codigo_documento = $("#tipo_codigo_documento").val();;

        var documento_numero = $("#documento_numero").val();

        if(membro_sexo !="0" && membro_nome !="" && membro_actividade !="0" && membro_contacto !="" && membro_endereco !="" && membro_herdeiro !="" &&
            herdeiro_grau_parent !="0" && tipo_codigo_documento !="0" && documento_numero !="") {

            $.ajax({
                type: 'POST', //Or 'GET',
                url: ip+"php/controller/adicionar/addmembro.php?membro_nome=" + membro_nome + "&membro_sexo=" + membro_sexo +
                "&membro_actividade=" + membro_actividade + "&membro_contacto=" + membro_contacto +
                "&membro_endereco=" + membro_endereco + "&membro_herdeiro=" + membro_herdeiro + "&herdeiro_grau_parent=" + herdeiro_grau_parent +
                "&tipo_codigo_documento=" + tipo_codigo_documento + "&documento_numero=" + documento_numero,
                success: function (data) {

                    var result = JSON.parse(data);

                    if(result.estado === 'sucesso'){


                        swal({

                            title: "Parabens!",
                            text:
                            "Cadastrado com sucesso<br>" +
                            "Nome   : <strong>"+result.membro_nome+"</strong><br>" +
                            "Codigo : <strong>"+result.membro_codigo+"</strong><br><br>" +
                            "<div class='row col-md-12'>" +
                            "<div class='col-md-6'>" +
                            "<a class='btn btn-block bg-blue-grey waves-effect col-md-6' href='cadastroMembro.html?token="+html+"'> Adicionar mais membros </a>" +
                            "<a class='btn btn-block bg-blue-grey waves-effect col-md-6' href='menu.html'> Menu </a>" +
                            "</div> " +
                            "</div> ",
                            type: "success",
                            showConfirmButton:false,
                            html: true
                        });

                    }else if(result.estado === 'erro'){
                        swal({

                            title: "Erro!",
                            text: "Ocorreu um erro, tente novamente <br> <br>" +
                            "<div class='row col-md-12'>" +
                            "<div class='col-md-6'>" +
                            "</div> " +
                            "</div> ",
                            type: "error",
                            showConfirmButton:true,


                            html: true
                        });
                    }else if(result.estado === 'existe'){
                        swal({

                            title: "Erro!",
                            text: "Membro ja registado <br> <br>" +
                            "<div class='row col-md-12'>" +
                            "<div class='col-md-6'>" +
                            "</div> " +
                            "</div> ",
                            type: "error",
                            showConfirmButton:true,


                            html: true
                        });
                    }else if(result.estado === 'login'){
                        swal({

                            title: "Erro!",
                            text: "Por Favor Efectui o Login Para Poder Cadastrar<br> <br>" +
                            "<div class='row col-md-12'>" +
                            "<div class='col-md-6'>" +
                            "<a class='btn btn-block bg-blue-grey waves-effect col-md-6' id='back' >Ok</a>" +
                            "</div> " +
                            "</div> ",
                            type: "error",
                            showConfirmButton:false,
                            html: true
                        });
                        $('#back').attr('href',ip+'index.html');
                    }else{
                        swal({

                            title: "Erro!",
                            text: "Ocorreu um erro, contacte o administrador <br> <br>" +
                            "<div class='row col-md-12'>" +
                            "<div class='col-md-6'>" +
                            "</div> " +
                            "</div> ",
                            type: "error",
                            showConfirmButton:true,


                            html: true
                        });
                    }

                    return false;
                },
                error: function () {

                    swal({

                        title: "Erro!",
                        text: "Ocorreu um erro, contacte o administrador <br> <br>" +
                        "<div class='row col-md-12'>" +
                        "<div class='col-md-6'>" +
                        "</div> " +
                        "</div> ",
                        type: "error",
                        showConfirmButton:true,


                        html: true
                    });
                    return false;
                }
            });

        }else{
            swal({

                title: "Erro!",
                text: "Preencha todos campos Por Favor <br> <br>" +
                "<div class='row col-md-12'>" +
                "<div class='col-md-6'>" +
                "</div> " +
                "</div> ",
                type: "error",
                showConfirmButton:true,
                html: true
            });
        }

    });

    $.ajax({
        type: 'POST', //Or 'GET',
        url: ip+"php/controller/pesquisar/dadosTecnico.php",
        success: function (data) {

            var result = JSON.parse(data);

            var nome = result.nome_tecnico;
            var email = result.email_tecnico;


            $('#nome_tecnico').text(nome);
            $('#email_tecnico').text(email);


            return false;
        },
        error: function () {

            alert("ocorreu um erro");

            return false;
        }
    });


    $('#membro_actividade').html(html);


</script>
</body>

</html>
